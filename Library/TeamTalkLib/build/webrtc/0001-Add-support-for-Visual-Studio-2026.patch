From 475de911477916388cc1d7ff0b8c545c978ee0c6 Mon Sep 17 00:00:00 2001
From: hwangsihu <129564966+hwangsihu@users.noreply.github.com>
Date: Fri, 27 Feb 2026 18:00:18 +0900
Subject: [PATCH] Add support for Visual Studio 2026

---
 vs_toolchain.py | 22 +++++++++++++++-------
 1 file changed, 15 insertions(+), 7 deletions(-)

diff --git a/vs_toolchain.py b/vs_toolchain.py
index d909f5b36..674d9f8d9 100755
--- a/vs_toolchain.py
+++ b/vs_toolchain.py
@@ -67,7 +67,8 @@ SDK_VERSION = '10.0.26100.0'
 # which makes a difference for the arm64 runtime.
 # The second number is an alternate version number, only used in an error string
 MSVS_VERSIONS = collections.OrderedDict([
-    ('2022', '17.0'),  # The VS version in our packaged toolchain.
+    ('2026', '18.0'),  # Default and packaged version of Visual Studio.
+    ('2022', '17.0'),
     ('2019', '16.0'),
     ('2017', '15.0'),
 ])
@@ -75,11 +76,16 @@ MSVS_VERSIONS = collections.OrderedDict([
 # List of preferred VC toolset version based on MSVS
 # Order is not relevant for this dictionary.
 MSVC_TOOLSET_VERSION = {
+    '2026': 'VC145',
     '2022': 'VC143',
     '2019': 'VC142',
     '2017': 'VC141',
 }
 
+MSVS_YEAR_TO_PATH = {
+    '2026': '18',
+}
+
 script_dir = os.path.dirname(os.path.realpath(__file__))
 json_data_file = os.path.join(script_dir, 'win_toolchain.json')
 
@@ -211,8 +217,9 @@ def GetVisualStudioVersion():
       program_files_path_variable = '%ProgramFiles%'
     else:
       program_files_path_variable = '%ProgramFiles(x86)%'
+    path_version = MSVS_YEAR_TO_PATH.get(version, version)
     path = os.path.expandvars(program_files_path_variable +
-                              '/Microsoft Visual Studio/%s' % version)
+                              '/Microsoft Visual Studio/%s' % path_version)
     if path and any(
         os.path.exists(os.path.join(path, edition))
         for edition in ('Enterprise', 'Professional', 'Community', 'Preview',
@@ -242,22 +249,23 @@ def DetectVisualStudioPath():
     program_files_path_variable = '%ProgramFiles%'
   else:
     program_files_path_variable = '%ProgramFiles(x86)%'
+  path_version = MSVS_YEAR_TO_PATH.get(version_as_year, version_as_year)
   for path in (os.environ.get('vs%s_install' % version_as_year),
                os.path.expandvars(program_files_path_variable +
                                   '/Microsoft Visual Studio/%s/Enterprise' %
-                                  version_as_year),
+                                  path_version),
                os.path.expandvars(program_files_path_variable +
                                   '/Microsoft Visual Studio/%s/Professional' %
-                                  version_as_year),
+                                  path_version),
                os.path.expandvars(program_files_path_variable +
                                   '/Microsoft Visual Studio/%s/Community' %
-                                  version_as_year),
+                                  path_version),
                os.path.expandvars(program_files_path_variable +
                                   '/Microsoft Visual Studio/%s/Preview' %
-                                  version_as_year),
+                                  path_version),
                os.path.expandvars(program_files_path_variable +
                                   '/Microsoft Visual Studio/%s/BuildTools' %
-                                  version_as_year)):
+                                  path_version)):
     if path and os.path.exists(path):
       return path
 
-- 
2.53.0.windows.1

